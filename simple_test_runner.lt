# ===============================
# LATCH SIMPLE TEST RUNNER
# ===============================

print("=== LATCH TEST SUITE START ===")
start_time := time.now()

# Test results
total_tests := 0
passed_tests := 0

# Helper function to run test
fn run_test(test_name, test_file) {
    print("\n--- Running ${test_name} ---")
    total_tests += 1
    
    try {
        result := proc.exec(["latch", "run", test_file])
        if result.code == 0 {
            print("âœ“ ${test_name} PASSED")
            passed_tests += 1
            return true
        } else {
            print("âœ— ${test_name} FAILED (exit code: ${result.code})")
            return false
        }
    } catch e {
        print("âœ— ${test_name} ERROR: ${typeof(e)}")
        return false
    }
}

# Run tests
print("Starting test execution...")

# 1. Comprehensive Stress Test
run_test("Comprehensive Stress Test", "comprehensive_stress_test.lt")

# 2. Edge Cases Test  
run_test("Edge Cases Test", "edge_cases_test_simple.lt")

# 3. Original Stress Test (if exists)
run_test("Original Stress Test", "stress.lt")

# Results
end_time := time.now()
success_rate := 0
if total_tests > 0 {
    success_rate = (passed_tests * 100) / total_tests
}

print("\n" + "="*50)
print("           TEST RESULTS SUMMARY")
print("="*50)
print("Total Tests: ${total_tests}")
print("Passed: ${passed_tests}")
failed_count := total_tests - passed_tests
print("Failed: ${failed_count}")
print("Success Rate: ${success_rate}")
print("Execution Time: Check timestamps above")

if success_rate == 100 {
    print("\nðŸŽ‰ ALL TESTS PASSED!")
    print("Latch Lang is working correctly!")
}
if success_rate >= 80 && success_rate < 100 {
    print("\nâš ï¸  Most tests passed. Review failures.")
}
if success_rate < 80 {
    print("\nâŒ Multiple test failures. Attention needed.")
}

print("\n=== LATCH TEST SUITE COMPLETED ===")

if success_rate == 100 {
    stop 0
} else {
    stop 1
}
