# ===============================
# LATCH BASIC TEST RUNNER
# ===============================

print("=== LATCH TEST SUITE START ===")

# Test results
total_tests := 0
passed_tests := 0

# Helper function to run test
fn run_test(test_name, test_file) {
    print("\n--- Running ${test_name} ---")
    total_tests = total_tests + 1
    
    try {
        result := proc.exec(["latch", "run", test_file])
        if result.code == 0 {
            print("âœ“ ${test_name} PASSED")
            passed_tests = passed_tests + 1
            return true
        } else {
            print("âœ— ${test_name} FAILED")
            return false
        }
    } catch e {
        print("âœ— ${test_name} ERROR")
        return false
    }
}

# Run tests
print("Starting test execution...")

# 1. Comprehensive Stress Test
run_test("Comprehensive Stress Test", "comprehensive_stress_test.lt")

# 2. Edge Cases Test  
run_test("Edge Cases Test", "edge_cases_test_simple.lt")

# 3. Original Stress Test (if exists)
run_test("Original Stress Test", "stress.lt")

# Results
print("\n" + "="*50)
print("           TEST RESULTS SUMMARY")
print("="*50)

total_str := str(total_tests)
passed_str := str(passed_tests)
failed_count := total_tests - passed_tests
failed_str := str(failed_count)

print("Total Tests: " + total_str)
print("Passed: " + passed_str)
print("Failed: " + failed_str)

success_rate := 0
if total_tests > 0 {
    success_rate = (passed_tests * 100) / total_tests
}
rate_str := str(success_rate)
print("Success Rate: " + rate_str)

if success_rate == 100 {
    print("\nðŸŽ‰ ALL TESTS PASSED!")
    print("Latch Lang is working correctly!")
}
if success_rate >= 80 && success_rate < 100 {
    print("\nâš ï¸  Most tests passed. Review failures.")
}
if success_rate < 80 {
    print("\nâŒ Multiple test failures. Attention needed.")
}

print("\n=== LATCH TEST SUITE COMPLETED ===")

if success_rate == 100 {
    stop 0
} else {
    stop 1
}
